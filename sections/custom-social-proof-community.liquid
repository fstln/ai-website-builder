{% comment %}
  Social Proof (Community) Section
  - Displays customer testimonials or reviews in a grid format.
{% endcomment %}

{%- liquid
  assign section_dom_id = 'section-' | append: section.id
  assign color_scheme = section.settings.color_scheme | default: 'scheme-1'
-%}

<section
  id="{{ section_dom_id }}"
  class="color-scheme color-{{ color_scheme }} relative overflow-hidden py-20"
>
  <div class="container mx-auto px-6 md:px-12 lg:px-20">
    <div class="mx-auto mb-16 max-w-2xl text-center">
      {%- if section.settings.heading != blank -%}
        <h2 class="text-3xl font-bold text-foreground md:text-4xl mb-4">
          {{ section.settings.heading }}
        </h2>
      {%- endif -%}
    </div>

    {%- if section.blocks.size > 0 -%}
      <div class="grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-3">
        {%- for block in section.blocks -%}
          <article
            class="flex h-full flex-col rounded-[24px] border border-gray-50 bg-white p-8 shadow-[0_8px_30px_rgb(0,0,0,0.04)]"
            {{ block.shopify_attributes }}
          >
            {%- if block.settings.quote != blank -%}
              <p class="flex-grow leading-relaxed text-gray-700 mb-6">
                {{ block.settings.quote }}
              </p>
            {%- endif -%}
            <div class="mt-auto flex items-center gap-4">
              {%- if block.settings.avatar != blank -%}
                <img
                  src="{{ block.settings.avatar | image_url: width: 100 }}"
                  alt="{{ block.settings.avatar.alt | default: block.settings.author | escape }}"
                  width="48"
                  height="48"
                  class="h-12 w-12 rounded-full bg-gray-100 object-cover"
                  loading="lazy"
                >
              {%- else -%}
                <div class="h-12 w-12 rounded-full bg-gray-100"></div>
              {%- endif -%}
              <div>
                {%- if block.settings.author != blank -%}
                  <h4 class="text-sm font-bold text-foreground">
                    {{ block.settings.author }}
                  </h4>
                {%- endif -%}
              </div>
            </div>
          </article>
        {%- endfor -%}
      </div>
    {%- endif -%}
  </div>
</section>

{% schema %}
{
  "name": "C: Social Proof",
  "tag": "section",
  "max_blocks": 6,
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color Scheme",
      "default": "scheme-1"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Trusted by the Heyup Community"
    }
  ],
  "blocks": [
    {
      "type": "review",
      "name": "Review",
      "settings": [
        {
          "type": "image_picker",
          "id": "avatar",
          "label": "Author Avatar"
        },
        {
          "type": "richtext",
          "id": "quote",
          "label": "Quote",
          "default": "<p>\"The Oladance OWS has completely changed how I work from home.\"</p>"
        },
        {
          "type": "text",
          "id": "author",
          "label": "Author Name",
          "default": "James D."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "C: Social Proof",
      "blocks": [
        {
          "type": "review",
          "settings": {
            "quote": "<p>\"4.8/5 rated by Heyup Testers.\"</p>",
            "author": "Heyup Community"
          }
        },
        { "type": "review" }
      ]
    }
  ]
}
{% endschema %}
