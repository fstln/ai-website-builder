{% comment %}
  Main Product Section - High-Converting DTC Design
  Based on visual_spec.md and DTC best practices
{% endcomment %}

{% assign section_color_scheme = section.settings.color_scheme | default: 'scheme-1' %}
{% assign ribbon_color_start = section.settings.discount_ribbon_color_start | default: '#EF4444' %}
{% assign ribbon_color_end = section.settings.discount_ribbon_color_end | default: '#EF4444' %}
{% assign ribbon_text_color = section.settings.discount_ribbon_text_color | default: '#FFFFFF' %}

{% style %}
  #shopify-section-{{ section.id }} .dynamic-checkout-button {
    width: 100%;
  }

  #shopify-section-{{ section.id }} .dynamic-checkout-button .shopify-payment-button {
    display: grid;
    gap: 0.75rem;
  }

  #shopify-section-{{ section.id }} .dynamic-checkout-button shopify-payment-button {
    width: 100%;
  }

  #shopify-section-{{ section.id }} .dynamic-checkout-button :is(shopify-accelerated-checkout, shopify-accelerated-checkout-cart) {
    --shopify-accelerated-checkout-inline-alignment: stretch;
    --shopify-accelerated-checkout-row-gap: 0.75rem;
    --shopify-accelerated-checkout-button-border-radius: var(--radius-md, 12px);
    --shopify-accelerated-checkout-button-block-size: var(--button-min-height, 44px);
  }

  #shopify-section-{{ section.id }} .dynamic-checkout-button more-payment-options-link {
    font-size: 0.875rem;
    text-align: center;
    font-weight: 500;
  }

  #shopify-section-{{ section.id }} .dynamic-checkout-button more-payment-options-link a {
    color: var(--color-primary);
    text-decoration: none;
  }

  #shopify-section-{{ section.id }} .dynamic-checkout-button more-payment-options-link a:hover {
    color: rgb(var(--color-primary-rgb) / 0.8);
  }

  #shopify-section-{{ section.id }} .promotion-discount-bar__button--claimed {
    opacity: 0.85;
  }

  #shopify-section-{{ section.id }} .promotion-discount-bar {
    background: var(--promotion-background, rgba(239, 68, 68, 0.08));
    border-color: var(--promotion-border, rgba(239, 68, 68, 0.3));
    color: var(--promotion-foreground, #7a1b1b);
  }

  #shopify-section-{{ section.id }} .promotion-discount-bar__badge {
    font-weight: 600;
    text-transform: uppercase;
    color: var(--promotion-foreground, #7a1b1b);
    opacity: 0.8;
  }

  #shopify-section-{{ section.id }} .promotion-discount-bar__heading {
    color: var(--promotion-foreground, #7a1b1b);
  }

  #shopify-section-{{ section.id }} .promotion-discount-bar__subtext {
    color: var(--promotion-foreground, #7a1b1b);
    opacity: 0.75;
  }

  #shopify-section-{{ section.id }} .promotion-discount-bar__code {
    color: var(--promotion-foreground, #7a1b1b);
    border-color: var(--promotion-border, rgba(239, 68, 68, 0.3));
  }

  #shopify-section-{{ section.id }} .promotion-discount-bar__claim {
    color: var(--promotion-foreground, #7a1b1b);
    border-bottom: 1px solid transparent;
    padding: 0;
    background: transparent;
    border-radius: 0;
    font-weight: 600;
    text-decoration: underline;
    text-decoration-thickness: 2px;
    text-underline-offset: 4px;
  }

  #shopify-section-{{ section.id }} .promotion-discount-bar__claim:hover {
    opacity: 0.85;
  }

  #shopify-section-{{ section.id }} .promotion-discount-bar__claim.promotion-discount-bar__button--claimed {
    opacity: 0.75;
    text-decoration: none;
  }

  #shopify-section-{{ section.id }} .product-discount-ribbon {
    position: absolute;
    top: 0;
    left: 1.5rem;
    padding: .5rem .5rem 1rem;
    background-image: linear-gradient(135deg, {{ ribbon_color_start }}, {{ ribbon_color_end }});
    color: {{ ribbon_text_color }};
    display: inline-flex;
    flex-direction: column;
    gap: 0.1rem;
    text-transform: uppercase;
    box-shadow: 0 20px 30px rgb(15 23 42 / 0.25);
    clip-path: polygon(0 0, 100% 0%, 100% 100%, 50% 85%, 0 100%);
    z-index: 10;
  }

  #shopify-section-{{ section.id }} .product-discount-ribbon__amount {
    font-size: 1.35rem;
    font-weight: 800;
    line-height: 1.1;
  }

  #shopify-section-{{ section.id }} .product-discount-ribbon__label {
    font-size: 0.75rem;
    font-weight: 600;
    color: inherit;
  }


  #shopify-section-{{ section.id }} .product-low-stock-badge {
    top: calc(1.5rem + 110px);
    left: 1.5rem;
    z-index: 9;
    box-shadow: 0 10px 20px rgb(15 23 42 / 0.15);
  }

  @media (min-width: 1024px) {
    #shopify-section-{{ section.id }} .product-layout {
      align-items: flex-start;
    }

    #shopify-section-{{ section.id }} .product-images,
    #shopify-section-{{ section.id }} .product-info {
      position: sticky;
      top: 2rem;
      align-self: flex-start;
      max-height: calc(100vh - 3rem);
      overflow-y: auto;
      padding-right: 0.5rem;
      scrollbar-width: none;
    }

    #shopify-section-{{ section.id }} .product-info {
      padding-right: 1rem;
    }

    #shopify-section-{{ section.id }} .product-images::-webkit-scrollbar,
    #shopify-section-{{ section.id }} .product-info::-webkit-scrollbar {
      width: 0;
      height: 0;
    }

    #shopify-section-{{ section.id }} .product-images::-webkit-scrollbar-thumb,
    #shopify-section-{{ section.id }} .product-info::-webkit-scrollbar-thumb {
      background: transparent;
    }
  }

  #shopify-section-{{ section.id }} .global-sticky-bar {
    background-color: rgb(var(--color-background-rgb, 255 255 255) / 0.95);
    border-top: 1px solid rgb(var(--color-border-rgb, 148 163 184) / 0.5);
    box-shadow: 0 -8px 40px rgb(15 23 42 / 0.08);
    backdrop-filter: blur(10px);
  }
{% endstyle %}

<section class="color-scheme color-{{ section_color_scheme }} section-main-product">
  <div class="w-full min-h-screen bg-background text-foreground">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-12">    
    {%- comment -%} Product Grid - Image left, Info right, stacked on mobile {%- endcomment -%}
    <div class="product-layout grid grid-cols-1 lg:grid-cols-2 gap-8 lg:gap-12 mt-6">
      
      {%- comment -%} Left: Product Image Gallery {%- endcomment -%}
      <div class="product-images lg:max-h-[calc(100vh-3rem)] lg:overflow-y-auto lg:pr-2">
        {% assign selected_media = product.selected_or_first_available_variant.featured_media | default: product.featured_media %}
        {% assign selected_media_id = selected_media.id %}
        
        {% if product.media.size > 0 %}
          <div class="lg:hidden mb-4">
            <div class="flex gap-4 overflow-x-auto overflow-y-hidden overscroll-x-contain overscroll-y-none snap-x snap-mandatory scroll-px-4 pb-2" data-thumbnail-track>
              {% if selected_media %}
                <div class="relative rounded-2xl overflow-hidden snap-start shrink-0 bg-background mobile-gallery__item">
                  <img
                    src="{{ selected_media.preview_image | image_url: width: 900 }}"
                    alt="{{ selected_media.alt | default: product.title }}"
                    loading="lazy"
                    class="w-full aspect-square object-cover"
                    data-variant-thumbnail
                  >
                </div>
              {% endif %}
              
              {% for media in product.media %}
                {% if selected_media and media.id == selected_media_id %}
                  {% continue %}
                {% endif %}
                <div class="relative rounded-2xl overflow-hidden snap-start shrink-0 bg-background mobile-gallery__item">
                  <img
                    src="{{ media.preview_image | image_url: width: 900 }}"
                    alt="{{ media.alt | default: product.title }}"
                    loading="lazy"
                    class="w-full aspect-square object-cover"
                  >
                  {% if media.media_type == 'video' or media.media_type == 'external_video' %}
                    <div class="absolute inset-0 flex items-center justify-center bg-black/25">
                      {% render 'icon', name: 'play', class: 'w-9 h-9 text-white' %}
                    </div>
                  {% endif %}
                </div>
              {% endfor %}
            </div>
          </div>
        {% endif %}
        
        {% if product.media.size > 0 %}
          <product-gallery-component 
            class="product-gallery space-y-4 hidden lg:block"
          >
            {%- comment -%} Main Image - rounded-lg 8px {%- endcomment -%}
            <div class="main-image relative cursor-pointer bg-background rounded-lg overflow-hidden" ref="mainImage" data-product-gallery-main>
              {% assign featured_media = product.selected_or_first_available_variant.featured_media | default: product.featured_media %}
              
              <img
                src="{{ featured_media | image_url: width: 1200 }}"
                alt="{{ featured_media.alt | default: product.title }}"
                width="1200"
                height="1200"
                loading="eager"
                class="w-full aspect-square object-cover transition-transform duration-300 hover:scale-105"
                data-main-image
              >
              
              {%- comment -%} Sale Badge - hero ribbon {%- endcomment -%}
              {% if product.compare_at_price > product.price %}
                {% assign savings_amount = product.compare_at_price | minus: product.price %}
                {% assign savings_percent = savings_amount | times: 100 | divided_by: product.compare_at_price %}
                <div class="product-discount-ribbon text-center flex" aria-label="Save {{ savings_amount | money }}">
                  <span class="product-discount-ribbon__amount">{{ savings_amount | money_without_trailing_zeros }}</span>
                  <span class="product-discount-ribbon__label">OFF</span>
                </div>
              {% endif %}
              
              {%- comment -%} Low Stock Badge {%- endcomment -%}
              {% assign current_variant = product.selected_or_first_available_variant %}
              {% if current_variant.inventory_quantity <= 10 and current_variant.inventory_quantity > 0 %}
                <div class="absolute product-low-stock-badge bg-warning text-background text-xs font-semibold px-3 py-1.5 rounded-full">
                  {{ 'products.product.low_stock' | t }} - {{ current_variant.inventory_quantity }} {{ 'general.cart.item_count.other' | t: count: current_variant.inventory_quantity }}
                </div>
              {% endif %}
            </div>
            
            {%- comment -%} Thumbnails - rounded-lg 8px {%- endcomment -%}
            {% if product.media.size > 1 %}
              <div class="product-thumbnails mt-4 grid grid-cols-2 gap-3">
                {% for media in product.media limit: 4 %}
                  <div 
                    class="thumbnail relative bg-background overflow-hidden transition-all duration-200"
                    ref="thumbnails[]"
                    on:click="/selectSlide/{{ forloop.index0 }}"
                    data-media-id="{{ media.id }}"
                    aria-label="Switch to image {{ forloop.index }}"
                  >
                    {% if media.media_type == 'video' or media.media_type == 'external_video' %}
                      <img
                        src="{{ media.preview_image | image_url: width: 600 }}"
                        alt="{{ media.alt | default: product.title }}"
                        loading="lazy"
                        class="w-full aspect-square object-cover"
                      >
                      <div class="absolute inset-0 flex items-center justify-center bg-black/20">
                        {% render 'icon', name: 'play', class: 'w-8 h-8 text-white' %}
                      </div>
                    {% else %}
                      <img
                        src="{{ media.preview_image | image_url: width: 600 }}"
                        alt="{{ media.alt | default: product.title }}"
                        loading="lazy"
                        class="w-full aspect-square object-cover"
                      >
                    {% endif %}
                  </div>
                {% endfor %}
              </div>
            {% endif %}
          </product-gallery-component>
        {% endif %}
        
        {%- comment -%} Trust Badges {%- endcomment -%}
        <div class="trust-badges"></div> 
      </div>
      
      {%- comment -%} Right: Product Info & Buy Area {%- endcomment -%}
      <div class="product-info">
        {%- comment -%} Vendor - Small Label {%- endcomment -%}
        {% comment %} {% if product.vendor != blank %}
          <a href="{{ product.vendor | url_for_vendor }}" class="inline-flex items-center text-xs font-medium text-primary hover:text-primary/80 mb-3 transition-colors">
            {{ product.vendor }}
            {% render 'icon', name: 'arrow-right', class: 'w-3.5 h-3.5 ml-1' %}
          </a>
        {% endif %} {% endcomment %}
        <product-form-component
          class="product-form-wrapper"
          data-product-id="{{ product.id }}"
          data-section-id="{{ section.id }}"
          data-product-url="{{ product.url }}"
          on:submit="/handleSubmit"
        >
          <div
            class="visually-hidden"
            aria-live="assertive"
            role="status"
            aria-atomic="true"
            ref="liveRegion"
          ></div>
          
          {% form 'product', product, class: 'product-form space-y-6', data-type: 'add-to-cart-form' %}
            <input 
              type="hidden" 
              name="id" 
              value="{{ product.selected_or_first_available_variant.id }}"
              ref="variantId"
              data-product-variant-id
            >
            {% assign current_variant = product.selected_or_first_available_variant %}
            {% if section.blocks.size > 0 %}
              {% assign has_purchase_blocks = true %}
            {% else %}
              {% assign has_purchase_blocks = false %}
            {% endif %}
            {% if has_purchase_blocks %}
              {% for block in section.blocks %}
                {% assign block_type = block.type %}
                {% assign block_attributes = block.shopify_attributes %}
                {% case block_type %}
                  {% when 'product_title' %}
                    <h1 class="text-3xl sm:text-4xl font-extrabold tracking-tight text-foreground leading-tight mb-6" {{ block_attributes }}>
                      {{ product.title }}
                    </h1>
                  {% when 'product_price' %}
                    <div class="product-price bg-background rounded-2xl mb-8" {{ block_attributes }}>
                      <div class="flex items-center gap-3 mb-6">
                        {% if product.compare_at_price > product.price %}
                          <span class="text-3xl text-foreground">
                            {{ product.price | money }}
                          </span>
                          <span class="text-2xl font-medium text-muted line-through">
                            {{ product.compare_at_price | money }}
                          </span>
                          <span class="inline-flex items-center px-3 py-1 bg-error text-background text-sm font-bold rounded-full">
                            {% assign savings_amount = product.compare_at_price | minus: product.price | money %}
                            {{ 'products.product.save_amount' | t: amount: savings_amount }}
                          </span>
                        {% else %}
                          <span class="text-4xl text-foreground">
                            {{ product.price | money }}
                          </span>
                        {% endif %}
                      </div>
                    </div>
                  {% when 'promotion_discount_bar' %}
                    {% liquid
                      assign discount_code = block.settings.discount_code | strip
                      assign promo_heading = block.settings.promo_heading | strip
                      assign promo_subtext = block.settings.promo_subtext | strip
                      assign badge_label = block.settings.badge_label | strip
                      assign button_label = block.settings.button_label | default: 'Claim discount'
                      assign claimed_label = block.settings.claimed_label | default: 'Discount saved'
                      assign promo_background = block.settings.background_color | default: 'rgba(239, 68, 68, 0.1)'
                      assign promo_text_color = block.settings.text_color | default: '#7a1b1b'
                      assign promo_border_color = promo_text_color
                      if promo_text_color contains 'rgb'
                        assign promo_border_color = promo_text_color
                      else
                        assign promo_border_color = promo_text_color | color_modify: 'alpha', 0.35
                      endif
                      capture promo_styles
                        echo '--promotion-background: ' | append: promo_background | append: ';'
                        echo '--promotion-foreground: ' | append: promo_text_color | append: ';'
                        echo '--promotion-border: ' | append: promo_border_color | append: ';'
                      endcapture
                    %}
                    {% if discount_code != blank or promo_heading != blank or promo_subtext != blank or badge_label != blank %}
                      <div class="promotion-discount-bar rounded-2xl border p-5 sm:p-6 space-y-4" style="{{ promo_styles | strip_newlines | strip }}" {{ block_attributes }}>
                        {% if badge_label != blank %}
                          <p class="promotion-discount-bar__badge text-xs">
                            {{ badge_label | escape }}
                          </p>
                        {% endif %}
                        <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
                          <div class="space-y-1.5">
                            {% if promo_heading != blank %}
                              <p class="promotion-discount-bar__heading text-lg font-bold">{{ promo_heading | escape }}</p>
                            {% endif %}
                            {% if promo_subtext != blank %}
                              <p class="promotion-discount-bar__subtext text-sm">{{ promo_subtext | escape }}</p>
                            {% endif %}
                          </div>
                          {% if discount_code != blank %}
                            <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:gap-4">
                              <button
                                type="button"
                                class="promotion-discount-bar__claim inline-flex items-center gap-2 text-sm"
                                data-promotion-claim
                                data-discount-code="{{ discount_code | escape }}"
                                data-cookie-duration="{{ block.settings.cookie_duration | default: 30 }}"
                                data-success-text="{{ claimed_label | escape }}"
                                data-default-text="{{ button_label | escape }}"
                              >
                                <span data-claim-text>{{ button_label | escape }}</span>
                              </button>
                            </div>
                          {% endif %}
                        </div>
                      </div>
                    {% endif %}
                  {% when 'product_description' %}
                    {% if block.settings.description_content != blank %}
                      <div class="product-short-description text-base leading-relaxed text-foreground mb-6 pb-6" {{ block_attributes }}>
                        {{ block.settings.description_content }}
                      </div>
                    {% endif %}
                  {% when 'variant_selector' %}
                    {% unless product.has_only_default_variant %}
                      <div {{ block_attributes }}>
                        <variant-selector-component 
                          class="product-variants space-y-5"
                          data-product-id="{{ product.id }}"
                          data-product-url="{{ product.url }}"
                          data-section-id="{{ section.id }}"
                          data-product-page="true"
                        >
                          <script type="application/json">
                            {{ product | json }}
                          </script>
                          
                          {% for option in product.options_with_values %}
                            <div class="variant-option">
                              <label class="block text-sm font-semibold text-foreground mb-3">
                                {{ option.name }}
                                <span class="font-normal text-muted ml-2" data-selected-value-{{ option.name | handle }}>
                                  {% if option.selected_value %}
                                    - {{ option.selected_value }}
                                  {% endif %}
                                </span>
                              </label>

                              {% assign use_swatches = section.settings.enable_color_swatches %}

                              <div class="variant-buttons flex flex-wrap gap-2" role="radiogroup">
                                {% for value in option.values %}
                                  {% liquid
                                    assign option_value = value
                                    assign value_name = option_value.name | default: value
                                    assign value_handle = value_name | handle
                                    assign variant_for_value = option_value.variant
                                    if variant_for_value == nil
                                      if option.position == 1
                                        assign variant_for_value = product.variants | where: "option1", value_name | first
                                      elsif option.position == 2
                                        assign variant_for_value = product.variants | where: "option2", value_name | first
                                      else
                                        assign variant_for_value = product.variants | where: "option3", value_name | first
                                      endif
                                    endif
                                  %}
                                  <div class="variant-button-wrapper">
                                    <input
                                      type="radio"
                                      id="Option-{{ option.name | handle }}-{{ value_handle }}"
                                      name="options[{{ option.name }}]"
                                      value="{{ value_name }}"
                                      class="sr-only peer"
                                      data-variant-id="{{ variant_for_value.id }}"
                                      data-variant-image="{{ variant_for_value.featured_image | image_url: width: 1200 }}"
                                      {% if option_value.selected %}checked{% endif %}
                                      {% unless option_value.available %}disabled{% endunless %}
                                    >
                                    {% if use_swatches and option_value.swatch %}
                                      <label
                                        for="Option-{{ option.name | handle }}-{{ value_handle }}"
                                        title="{{ value_name }}"
                                        aria-label="{{ value_name }}"
                                        class="relative inline-flex items-center justify-center w-10 h-10 rounded-full border cursor-pointer transition-all duration-200
                                               {% if variant_for_value.available %}
                                                 border-border/80 bg-background hover:border-border peer-checked:border-primary peer-checked:ring-primary
                                               {% else %}
                                                 border-border/60 bg-border/15 cursor-not-allowed opacity-50
                                               {% endif %}"
                                      >
                                        <span class="sr-only">{{ value_name }}</span>
                                        {% if option_value.swatch.image %}
                                          {% assign swatch_image = option_value.swatch.image | image_url: width: 48, height: 48, crop: 'center' %}
                                          <span class="block w-6 h-6 rounded-full border border-border/50 bg-center bg-cover" style="background-image: url({{ swatch_image }});"></span>
                                        {% elsif option_value.swatch.color %}
                                          <span class="block w-6 h-6 rounded-full border border-border/50" style="background-color: {{ option_value.swatch.color }};"></span>
                                        {% else %}
                                          <span class="block w-6 h-6 rounded-full border border-border/50"></span>
                                        {% endif %}
                                      </label>
                                    {% else %}
                                      <label
                                        for="Option-{{ option.name | handle }}-{{ value_handle }}"
                                        class="inline-flex items-center justify-center min-w-[60px] px-4 py-2.5 text-sm font-medium rounded-lg border cursor-pointer transition-all duration-200
                                               {% if variant_for_value.available %}
                                                 border-border/80 bg-background text-foreground hover:border-border
                                                 peer-checked:border-primary peer-checked:bg-primary peer-checked:text-primary-foreground
                                               {% else %}
                                                 border-border/60 bg-border/15 text-muted/60 cursor-not-allowed line-through
                                               {% endif %}"
                                      >
                                        {{ value_name }}
                                      </label>
                                    {% endif %}
                                  </div>
                                {% endfor %}
                              </div>
                            </div>
                          {% endfor %}
                          
                          <div data-variant-error class="hidden text-sm font-medium text-error p-3 bg-error/10 border border-error/30 rounded-lg"></div>
                        </variant-selector-component>
                      </div>
                    {% endunless %}
                  {% when 'quantity_selector' %}
                    <div class="flex items-start gap-4" {{ block_attributes }}>
                      <div class="flex-shrink-0">
                        <label class="block text-sm font-semibold text-foreground mb-3">
                          {{ 'products.product.quantity' | t }}
                        </label>
                        {% render 'quantity-input', 
                          variant_id: current_variant.id,
                          value: 1,
                          min: 1,
                          label: product.title
                        %}
                      </div>
                    </div>
                  {% when 'buy_buttons' %}
                    <div class="space-y-4" {{ block_attributes }}>
                      <span class="hidden w-full text-sm font-medium text-error p-4 bg-error/10 border border-error/30 rounded-lg" ref="addToCartTextError" role="alert"></span>
                      {% if current_variant.available %}
                        {% assign product_variant_media = current_variant.featured_media.preview_image | image_url: width: 100 %}
                        {% if product_variant_media == blank %}
                          {% assign product_variant_media = product.featured_media.preview_image | image_url: width: 100 %}
                        {% endif %}
                        <add-to-cart-component
                          ref="addToCartButtonContainer"
                          data-product-variant-media="{{ product_variant_media }}"
                          data-add-to-cart-animation="false"
                          class="block"
                        >
                          <button 
                            type="submit"
                            name="add"
                            ref="addToCartButton"
                            on:click="/handleClick"
                            data-add-to-cart-button
                          class="btn btn-primary w-full text-lg font-semibold"
                          >
                            <span class="flex items-center justify-center gap-3">
                              {% render 'icon', name: 'cart-outline', class: 'w-6 h-6' %}
                              <span data-add-to-cart-text>{{ 'products.product.add_to_cart' | t }}</span>
                            </span>
                            <span class="absolute inset-0 flex items-center justify-center gap-2 text-base font-semibold text-primary-foreground transition-opacity duration-200 opacity-0 pointer-events-none" ref="addToCartSuccess">
                              {% render 'icon', name: 'check', class: 'w-6 h-6' %}
                              <span>{{ 'products.product.added' | t }}</span>
                            </span>
                          </button>
                        </add-to-cart-component>
                        {% if additional_checkout_buttons %}
                          <div class="accelerated-checkout-block dynamic-checkout-button w-full mt-3" data-dynamic-checkout>
                            {{ form | payment_button }}
                          </div>
                        {% endif %}
                      {% else %}
                        <button 
                          type="button"
                          disabled
                          class="btn w-full text-lg font-semibold bg-muted/40 text-primary-foreground cursor-not-allowed"
                        >
                          {{ 'products.product.sold_out' | t }}
                        </button>
                      {% endif %}
                    </div>
                {% endcase %}
              {% endfor %}
            {% else %}
              {% assign default_block_order = 'product_title|product_price|promotion_discount_bar|product_description|variant_selector|quantity_selector|buy_buttons' | split: '|' %}
              {% for fallback_block in default_block_order %}
                {% assign block_type = fallback_block %}
                {% assign block_attributes = '' %}
                {% case block_type %}
                  {% when 'product_title' %}
                    <h1 class="text-3xl sm:text-4xl font-extrabold tracking-tight text-foreground leading-tight mb-6">
                      {{ product.title }}
                    </h1>
                  {% when 'product_price' %}
                    <div class="product-price bg-background rounded-2xl mb-8">
                      <div class="flex items-baseline gap-3 mb-6">
                        {% if product.compare_at_price > product.price %}
                          <span class="text-4xl text-foreground">
                            {{ product.price | money }}
                          </span>
                          <span class="text-2xl font-medium text-muted line-through">
                            {{ product.compare_at_price | money }}
                          </span>
                          <span class="inline-flex items-center px-3 py-1 bg-error text-background text-sm font-bold rounded-full">
                            {{ 'products.product.save_amount' | t: amount: product.compare_at_price | minus: product.price | money }}
                          </span>
                        {% else %}
                          <span class="text-4xl text-foreground">
                            {{ product.price | money }}
                          </span>
                        {% endif %}
                      </div>
                    </div>
                  {% when 'promotion_discount_bar' %}
                    {% liquid
                      assign discount_code = 'SAVE15'
                      assign promo_heading = 'Extra 15% off for first-time customers'
                      assign promo_subtext = 'Use the code below and save instantly at checkout.'
                      assign badge_label = 'Limited time offer'
                      assign button_label = 'Claim discount'
                      assign claimed_label = 'Discount saved'
                      assign promo_background = 'rgba(239, 68, 68, 0.1)'
                      assign promo_text_color = '#7a1b1b'
                      assign promo_border_color = promo_text_color | color_modify: 'alpha', 0.35
                      capture promo_styles
                        echo '--promotion-background: ' | append: promo_background | append: ';'
                        echo '--promotion-foreground: ' | append: promo_text_color | append: ';'
                        echo '--promotion-border: ' | append: promo_border_color | append: ';'
                      endcapture
                    %}
                    <div class="promotion-discount-bar rounded-2xl border p-5 sm:p-6 space-y-4" style="{{ promo_styles | strip_newlines | strip }}">
                      <p class="promotion-discount-bar__badge text-xs">
                        {{ badge_label }}
                      </p>
                      <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
                        <div class="space-y-1.5">
                          <p class="promotion-discount-bar__heading text-lg font-bold">{{ promo_heading }}</p>
                          <p class="promotion-discount-bar__subtext text-sm">{{ promo_subtext }}</p>
                        </div>
                        <div class="flex flex-col gap-3 sm:flex-row sm:items-center sm:gap-4">
                          <div class="promotion-discount-bar__code inline-flex items-center justify-center px-4 py-2 rounded-xl border border-dashed bg-background/80 text-base font-semibold tracking-[0.3em] uppercase">
                            {{ discount_code }}
                          </div>
                          <button
                            type="button"
                            class="promotion-discount-bar__claim inline-flex items-center gap-2 text-sm"
                            data-promotion-claim
                            data-discount-code="{{ discount_code }}"
                            data-cookie-duration="30"
                            data-success-text="{{ claimed_label }}"
                            data-default-text="{{ button_label }}"
                          >
                            <span data-claim-text>{{ button_label }}</span>
                          </button>
                        </div>
                      </div>
                    </div>
                  {% when 'product_description' %}
                    {% assign fallback_description = '<p>Crafted for daily use with aerospace-grade materials, responsive haptics, and thoughtful ergonomics that elevate every interaction.</p>' %}
                    <div class="product-short-description text-base leading-relaxed text-foreground mb-6 pb-6">
                      {{ fallback_description }}
                    </div>
                  {% when 'variant_selector' %}
                    {% unless product.has_only_default_variant %}
                      <variant-selector-component 
                        class="product-variants space-y-5"
                        data-product-id="{{ product.id }}"
                        data-product-url="{{ product.url }}"
                        data-section-id="{{ section.id }}"
                        data-product-page="true"
                      >
                        <script type="application/json">
                          {{ product | json }}
                        </script>
                        {% for option in product.options_with_values %}
                          <div class="variant-option">
                            <label class="block text-sm font-semibold text-foreground mb-3">
                              {{ option.name }}
                              <span class="font-normal text-muted ml-2" data-selected-value-{{ option.name | handle }}>
                                {% if option.selected_value %}
                                  - {{ option.selected_value }}
                                {% endif %}
                              </span>
                            </label>

                            {% assign use_swatches = section.settings.enable_color_swatches %}

                            <div class="variant-buttons flex flex-wrap gap-2" role="radiogroup">
                              {% for value in option.values %}
                                {% liquid
                                  assign option_value = value
                                  assign value_name = option_value.name | default: value
                                  assign value_handle = value_name | handle
                                  assign variant_for_value = option_value.variant
                                  if variant_for_value == nil
                                    if option.position == 1
                                      assign variant_for_value = product.variants | where: "option1", value_name | first
                                    elsif option.position == 2
                                      assign variant_for_value = product.variants | where: "option2", value_name | first
                                    else
                                      assign variant_for_value = product.variants | where: "option3", value_name | first
                                    endif
                                  endif
                                %}
                                <div class="variant-button-wrapper">
                                  <input
                                    type="radio"
                                    id="Option-{{ option.name | handle }}-{{ value_handle }}"
                                    name="options[{{ option.name }}]"
                                    value="{{ value_name }}"
                                    class="sr-only peer"
                                    data-variant-id="{{ variant_for_value.id }}"
                                    data-variant-image="{{ variant_for_value.featured_image | image_url: width: 1200 }}"
                                    {% if option_value.selected %}checked{% endif %}
                                    {% unless option_value.available %}disabled{% endunless %}
                                  >
                                  {% if use_swatches and option_value.swatch %}
                                    <label
                                      for="Option-{{ option.name | handle }}-{{ value_handle }}"
                                      title="{{ value_name }}"
                                      aria-label="{{ value_name }}"
                                      class="relative inline-flex items-center justify-center w-10 h-10 rounded-full border cursor-pointer transition-all duration-200
                                             {% if variant_for_value.available %}
                                               border-border/80 bg-background hover:border-border peer-checked:border-primary peer-checked:ring-primary
                                             {% else %}
                                               border-border/60 bg-border/15 cursor-not-allowed opacity-50
                                             {% endif %}"
                                    >
                                      <span class="sr-only">{{ value_name }}</span>
                                      {% if option_value.swatch.image %}
                                        {% assign swatch_image = option_value.swatch.image | image_url: width: 48, height: 48, crop: 'center' %}
                                        <span class="block w-6 h-6 rounded-full border border-border/50 bg-center bg-cover" style="background-image: url({{ swatch_image }});"></span>
                                      {% elsif option_value.swatch.color %}
                                        <span class="block w-6 h-6 rounded-full border border-border/50" style="background-color: {{ option_value.swatch.color }};"></span>
                                      {% else %}
                                        <span class="block w-6 h-6 rounded-full border border-border/50"></span>
                                      {% endif %}
                                    </label>
                                  {% else %}
                                    <label
                                      for="Option-{{ option.name | handle }}-{{ value_handle }}"
                                    class="inline-flex items-center justify-center min-w-[60px] px-4 py-2.5 text-sm font-medium rounded-lg border cursor-pointer transition-all duration-200
                                           {% if variant_for_value.available %}
                                             border-border/80 bg-background text-foreground hover:border-border
                                             peer-checked:border-primary peer-checked:bg-primary peer-checked:text-primary-foreground
                                           {% else %}
                                             border-border/60 bg-border/15 text-muted/60 cursor-not-allowed line-through
                                           {% endif %}"
                                    >
                                      {{ value_name }}
                                    </label>
                                  {% endif %}
                                </div>
                              {% endfor %}
                            </div>
                          </div>
                        {% endfor %}
                        
                        <div data-variant-error class="hidden text-sm font-medium text-error p-3 bg-error/10 border border-error/30 rounded-lg"></div>
                      </variant-selector-component>
                    {% endunless %}
                  {% when 'quantity_selector' %}
                    <div class="flex items-start gap-4">
                      <div class="flex-shrink-0">
                        <label class="block text-sm font-semibold text-foreground mb-3">
                          {{ 'products.product.quantity' | t }}
                        </label>
                        {% render 'quantity-input', 
                          variant_id: current_variant.id,
                          value: 1,
                          min: 1,
                          label: product.title
                        %}
                      </div>
                    </div>
                  {% when 'buy_buttons' %}
                    <div class="space-y-4">
                      <span class="hidden w-full text-sm font-medium text-error p-4 bg-error/10 border border-error/30 rounded-lg" ref="addToCartTextError" role="alert"></span>
                      {% if current_variant.available %}
                        {% assign product_variant_media = current_variant.featured_media.preview_image | image_url: width: 100 %}
                        {% if product_variant_media == blank %}
                          {% assign product_variant_media = product.featured_media.preview_image | image_url: width: 100 %}
                        {% endif %}
                        <add-to-cart-component
                          ref="addToCartButtonContainer"
                          data-product-variant-media="{{ product_variant_media }}"
                          data-add-to-cart-animation="false"
                          class="block"
                        >
                          <button 
                            type="submit"
                            name="add"
                            ref="addToCartButton"
                            on:click="/handleClick"
                            data-add-to-cart-button
                            class="btn btn-primary w-full text-lg font-semibold"
                          >
                            <span class="flex items-center justify-center gap-3">
                              {% render 'icon', name: 'cart-outline', class: 'w-6 h-6' %}
                              <span data-add-to-cart-text>{{ 'products.product.add_to_cart' | t }}</span>
                            </span>
                            <span class="absolute inset-0 flex items-center justify-center gap-2 text-base font-semibold text-primary-foreground transition-opacity duration-200 opacity-0 pointer-events-none" ref="addToCartSuccess">
                              {% render 'icon', name: 'check', class: 'w-6 h-6' %}
                              <span>{{ 'products.product.added' | t }}</span>
                            </span>
                          </button>
                        </add-to-cart-component>
                        {% if additional_checkout_buttons %}
                          <div class="accelerated-checkout-block dynamic-checkout-button w-full mt-3" data-dynamic-checkout>
                            {{ form | payment_button }}
                          </div>
                        {% endif %}
                      {% else %}
                        <button 
                          type="button"
                          disabled
                          class="btn w-full text-lg font-semibold bg-muted/40 text-primary-foreground cursor-not-allowed"
                        >
                          {{ 'products.product.sold_out' | t }}
                        </button>
                      {% endif %}
                    </div>
                {% endcase %}
              {% endfor %}
            {% endif %}
          {% endform %}
        </product-form-component>
      </div>
      </div>
    </div>
  </div>
</section>

{% assign sticky_variant = product.selected_or_first_available_variant %}
{% if section.settings.enable_global_sticky_bar %}
  {%- comment -%} Global Sticky Purchase Bar {%- endcomment -%}
  <div class="global-sticky-bar fixed bottom-0 inset-x-0 z-40 transform translate-y-full transition-transform duration-300 border-t" data-sticky-bar data-sticky-mode="global">
    <div class="max-w-6xl mx-auto px-4 py-3 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
      <div class="flex-1 min-w-0">
        <p class="text-sm font-semibold text-foreground truncate" data-sticky-variant-title>{{ sticky_variant.title | default: product.title }}</p>
        <div class="flex items-baseline gap-2">
          <span class="text-lg font-bold text-foreground" data-sticky-price>{{ sticky_variant.price | money }}</span>
          <span class="text-sm text-muted line-through {% unless sticky_variant.compare_at_price > sticky_variant.price %}hidden{% endunless %}" data-sticky-compare-price>
            {% if sticky_variant.compare_at_price > sticky_variant.price %}
              {{ sticky_variant.compare_at_price | money }}
            {% endif %}
          </span>
        </div>
      </div>
      <div class="flex flex-col gap-2 w-full sm:w-auto sm:flex-row sm:items-center sm:gap-3">
        <button 
          type="button"
          onclick="document.querySelector('form.product-form').requestSubmit()"
          class="btn btn-primary w-full sm:w-auto text-base font-semibold flex items-center justify-center gap-2"
          data-sticky-add-to-cart
        >
          <span data-sticky-cart-text>{{ 'products.product.add_to_cart' | t }}</span>
        </button>
        <a 
          href="/cart/{{ sticky_variant.id }}:1"
          class="btn btn-secondary w-full sm:w-auto text-base font-semibold flex items-center justify-center gap-2"
          data-sticky-checkout-link
        >
          <span>{{ 'products.product.checkout' | t | default: 'Checkout' }}</span>
        </a>
      </div>
    </div>
  </div>
{% else %}
  {%- comment -%} Sticky Add to Cart Bar (Mobile) {%- endcomment -%}
  <div class="lg:hidden fixed bottom-0 inset-x-0 bg-background/95 backdrop-blur z-40 transform translate-y-full transition-transform duration-300" id="stickyCartBar" data-sticky-bar data-sticky-mode="mobile">
    <div class="px-4 py-3 flex items-center gap-3">
      <div class="flex-1 min-w-0">
        <p class="text-xs text-muted truncate">{{ product.title }}</p>
        <p class="text-sm font-semibold text-foreground truncate" data-sticky-variant-title>{{ sticky_variant.title | default: product.title }}</p>
        <div class="flex items-baseline gap-2">
          <span class="text-lg font-bold text-foreground" data-sticky-price>{{ sticky_variant.price | money }}</span>
          <span class="text-xs text-muted line-through {% unless sticky_variant.compare_at_price > sticky_variant.price %}hidden{% endunless %}" data-sticky-compare-price>
            {% if sticky_variant.compare_at_price > sticky_variant.price %}
              {{ sticky_variant.compare_at_price | money }}
            {% endif %}
          </span>
        </div>
      </div>
      <button 
        type="button"
        onclick="document.querySelector('form.product-form').requestSubmit()"
        class="btn btn-primary flex-shrink-0 px-6 py-3 text-base font-bold flex items-center gap-2"
        data-sticky-add-to-cart
      >
        {% render 'icon', name: 'cart-outline', class: 'w-5 h-5' %}
        <span data-sticky-cart-text>{{ 'products.product.add_to_cart' | t }}</span>
      </button>
    </div>
  </div>
{% endif %}

{%- comment -%} JavaScript for Sticky Bar and Variant Image Switch {%- endcomment -%}
<script>
(function() {
  const sectionRoot = document.getElementById('shopify-section-{{ section.id }}');
  const productForm = sectionRoot ? sectionRoot.querySelector('.product-form-wrapper') : document.querySelector('.product-form-wrapper');
  const stickyBars = document.querySelectorAll('[data-sticky-bar]');
  let lastScroll = 0;

  function handleStickyBars() {
    if (!productForm || !stickyBars.length) {
      return;
    }

    const formRect = productForm.getBoundingClientRect();
    const isFormVisible = formRect.top < window.innerHeight && formRect.bottom > 0;
    const currentScroll = window.pageYOffset;

    stickyBars.forEach((bar) => {
      const mode = bar.getAttribute('data-sticky-mode') || 'mobile';

      if (mode === 'global') {
        if (!isFormVisible) {
          bar.style.transform = 'translateY(0)';
        } else {
          bar.style.transform = 'translateY(100%)';
        }
      } else {
        if (window.innerWidth < 1024 && !isFormVisible && currentScroll > lastScroll) {
          bar.style.transform = 'translateY(0)';
        } else {
          bar.style.transform = 'translateY(100%)';
        }
      }
    });

    lastScroll = currentScroll;
  }

  if (stickyBars.length && productForm) {
    handleStickyBars();
    window.addEventListener('scroll', handleStickyBars, { passive: true });
    window.addEventListener('resize', handleStickyBars);
  }

  const stickyVariantTitles = document.querySelectorAll('[data-sticky-variant-title]');
  const stickyPriceElements = document.querySelectorAll('[data-sticky-price]');
  const stickyCompareElements = document.querySelectorAll('[data-sticky-compare-price]');
  const stickyCheckoutLinks = document.querySelectorAll('[data-sticky-checkout-link]');
  const moneyFormatter = (cents) => {
    if (window.Shopify && typeof window.Shopify.formatMoney === 'function') {
      return window.Shopify.formatMoney(cents);
    }
    return '$' + (cents / 100).toFixed(2);
  };
  let currentVariantData = {{ product.selected_or_first_available_variant | json }};

  function updateStickyBarContent(variant) {
    if (!variant) {
      return;
    }

    currentVariantData = variant;

    stickyVariantTitles.forEach((titleEl) => {
      if (titleEl) {
        titleEl.textContent = variant.title || '{{ product.title | escape }}';
      }
    });

    stickyPriceElements.forEach((priceEl) => {
      if (priceEl) {
        priceEl.textContent = moneyFormatter(variant.price);
      }
    });

    stickyCompareElements.forEach((compareEl) => {
      if (!compareEl) {
        return;
      }

      if (variant.compare_at_price && variant.compare_at_price > variant.price) {
        compareEl.textContent = moneyFormatter(variant.compare_at_price);
        compareEl.classList.remove('hidden');
      } else {
        compareEl.classList.add('hidden');
      }
    });

    stickyCheckoutLinks.forEach((link) => {
      if (link) {
        link.href = `/cart/${variant.id}:1`;
      }
    });
  }

  updateStickyBarContent(currentVariantData);

  document.addEventListener('variant:selected', function(event) {
    const variant = event.detail && event.detail.variant ? event.detail.variant : null;
    if (variant) {
      updateStickyBarContent(variant);
    }
  });
  
  // Update main image when variant changes
  document.addEventListener('change', function(e) {
    const target = e.target;
    
    // Check if it's a variant input with image data
    if (target.matches('input[name^="options"][data-variant-image]')) {
      const variantImage = target.getAttribute('data-variant-image');
      const mainImage = sectionRoot ? sectionRoot.querySelector('[data-main-image]') : document.querySelector('[data-main-image]');
      
      if (variantImage && variantImage !== '' && mainImage) {
        mainImage.src = variantImage;
      }

      const variantThumbnail = sectionRoot ? sectionRoot.querySelector('[data-variant-thumbnail]') : document.querySelector('[data-variant-thumbnail]');
      if (variantThumbnail && mainImage) {
        variantThumbnail.src = mainImage.src;
        if (mainImage.alt) {
          variantThumbnail.alt = mainImage.alt;
        }
      }

      const thumbnailTrack = sectionRoot ? sectionRoot.querySelector('[data-thumbnail-track]') : document.querySelector('[data-thumbnail-track]');
      if (thumbnailTrack) {
        thumbnailTrack.scrollTo({ left: 0, behavior: 'smooth' });
      }
    }
  });
  
  // Update sold out button text in sticky bar
  const addToCartButton = sectionRoot ? sectionRoot.querySelector('[data-add-to-cart-button]') : document.querySelector('[data-add-to-cart-button]');
  const stickyCartButtons = document.querySelectorAll('[data-sticky-add-to-cart]');
  const stickyCartTexts = document.querySelectorAll('[data-sticky-cart-text]');
  const soldOutText = '{{ 'products.product.sold_out' | t }}';
  const addToCartText = '{{ 'products.product.add_to_cart' | t }}';

  function setStickyButtonsState(disabled) {
    stickyCartButtons.forEach((button) => {
      if (!button) {
        return;
      }

      if (disabled) {
        button.disabled = true;
        button.classList.add('opacity-60', 'cursor-not-allowed');
      } else {
        button.disabled = false;
        button.classList.remove('opacity-60', 'cursor-not-allowed');
      }
    });

    stickyCartTexts.forEach((textEl) => {
      if (textEl) {
        textEl.textContent = disabled ? soldOutText : addToCartText;
      }
    });
  }

  if (addToCartButton && stickyCartButtons.length > 0) {
    setStickyButtonsState(addToCartButton.disabled);

    // Sync disabled state
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'disabled') {
          setStickyButtonsState(addToCartButton.disabled);
        }
      });
    });
    
    observer.observe(addToCartButton, { attributes: true });
  }

  const promotionButtons = sectionRoot ? sectionRoot.querySelectorAll('[data-promotion-claim]') : [];

  if (promotionButtons.length > 0) {
    const existingCode = getCookie('discount_code');

    promotionButtons.forEach(function(button) {
      const buttonCode = button.getAttribute('data-discount-code');
      if (existingCode && buttonCode === existingCode) {
        setPromoButtonState(button, 'claimed');
      }

      button.addEventListener('click', function() {
        const discountCode = button.getAttribute('data-discount-code');
        if (!discountCode) {
          return;
        }

        const cookieDays = parseInt(button.getAttribute('data-cookie-duration'), 10) || 30;
        setDiscountCookie(discountCode, cookieDays);

        promotionButtons.forEach(function(item) {
          const itemCode = item.getAttribute('data-discount-code');
          if (item === button || itemCode === discountCode) {
            setPromoButtonState(item, 'claimed');
          } else {
            setPromoButtonState(item, 'default');
          }
        });
      });
    });
  }

  function setDiscountCookie(code, days) {
    const ttl = (parseInt(days, 10) || 30) * 24 * 60 * 60 * 1000;
    const expires = new Date(Date.now() + ttl);
    document.cookie = 'discount_code=' + encodeURIComponent(code) + '; path=/; expires=' + expires.toUTCString() + '; SameSite=Lax';
  }

  function getCookie(name) {
    const value = `; ${document.cookie}`;
    const parts = value.split(`; ${name}=`);
    if (parts.length === 2) {
      return decodeURIComponent(parts.pop().split(';').shift());
    }
    return null;
  }

  function setPromoButtonState(button, state) {
    if (!button) {
      return;
    }

    const textNode = button.querySelector('[data-claim-text]');
    const defaultText = button.getAttribute('data-default-text') || '';
    const successText = button.getAttribute('data-success-text') || defaultText;

    if (state === 'claimed') {
      if (textNode && successText) {
        textNode.textContent = successText;
      } else if (successText) {
        button.textContent = successText;
      }
      button.classList.add('promotion-discount-bar__button--claimed');
      button.setAttribute('aria-pressed', 'true');
    } else {
      if (textNode && defaultText) {
        textNode.textContent = defaultText;
      } else if (defaultText) {
        button.textContent = defaultText;
      }
      button.classList.remove('promotion-discount-bar__button--claimed');
      button.removeAttribute('aria-pressed');
    }
  }
})();
</script>

{% schema %}
{
  "name": "Main Product",
  "tag": "section",
  "class": "section-main-product",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "checkbox",
      "id": "enable_color_swatches",
      "label": "Enable color swatches",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "enable_global_sticky_bar",
      "label": "Enable global sticky purchase bar",
      "default": false
    },
    {
      "type": "color",
      "id": "discount_ribbon_color_start",
      "label": "Discount tag color (start)",
      "default": "#EF4444"
    },
    {
      "type": "color",
      "id": "discount_ribbon_color_end",
      "label": "Discount tag color (end)",
      "default": "#FF4D1D"
    },
    {
      "type": "color",
      "id": "discount_ribbon_text_color",
      "label": "Discount tag text color",
      "default": "#FFFFFF"
    }
  ],
  "blocks": [
    {
      "type": "product_title",
      "name": "Product title",
      "limit": 1
    },
    {
      "type": "product_price",
      "name": "Price",
      "limit": 1
    },
    {
      "type": "promotion_discount_bar",
      "name": "Promotion discount bar",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "badge_label",
          "label": "Badge label",
          "default": "Limited time offer"
        },
        {
          "type": "text",
          "id": "promo_heading",
          "label": "Heading",
          "default": "Extra 15% off for first-time customers"
        },
        {
          "type": "text",
          "id": "promo_subtext",
          "label": "Subtext",
          "default": "Use the code below and save instantly at checkout."
        },
        {
          "type": "color_background",
          "id": "background_color",
          "label": "Background color",
          "default": "rgba(239, 68, 68, 0.1)"
        },
        {
          "type": "color",
          "id": "text_color",
          "label": "Text color",
          "default": "#7a1b1b"
        },
        {
          "type": "text",
          "id": "discount_code",
          "label": "Discount code",
          "default": "SAVE15"
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "Button label",
          "default": "Claim discount"
        },
        {
          "type": "text",
          "id": "claimed_label",
          "label": "Claimed state label",
          "default": "Discount saved"
        },
        {
          "type": "range",
          "id": "cookie_duration",
          "label": "Days to keep discount cookie",
          "min": 1,
          "max": 90,
          "step": 1,
          "default": 30
        }
      ]
    },
    {
      "type": "product_description",
      "name": "Product description",
      "limit": 1,
      "settings": [
        {
          "type": "richtext",
          "id": "description_content",
          "label": "Description content",
          "default": "<p>Describe your hero product highlights, materials, and key benefits in a couple of punchy sentences.</p>"
        }
      ]
    },
    {
      "type": "variant_selector",
      "name": "Variant selector",
      "limit": 1
    },
    {
      "type": "quantity_selector",
      "name": "Quantity selector",
      "limit": 1
    },
    {
      "type": "buy_buttons",
      "name": "Buy buttons",
      "limit": 1
    }
  ],
  "presets": [
    {
      "name": "Main Product",
      "blocks": [
        { "type": "product_title" },
        { "type": "product_price" },
        { "type": "promotion_discount_bar" },
        { "type": "product_description" },
        { "type": "variant_selector" },
        { "type": "quantity_selector" },
        { "type": "buy_buttons" }
      ]
    }
  ]
}
{% endschema %}
