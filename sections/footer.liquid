{% comment %}
  Footer Section - Modern DTC Design
  Layout: Newsletter (full width) -> Navigation columns + Contact -> Copyright + Payment icons
{% endcomment %}

{% liquid
  assign footer_menu = linklists[section.settings.footer_menu]
  assign menu_links = footer_menu.links
  assign section_color_scheme = section.settings.color_scheme | default: 'scheme-1'
%}

<footer 
  class="color-scheme color-{{ section_color_scheme }} site-footer heyup-footer" 
  data-footer>
  <div class="footer__container container-custom">

    {% comment %} Blocks: Newsletter (with its own color scheme) {% endcomment %}
    {% for block in section.blocks %}
      {% case block.type %}
        {% when 'newsletter' %}
          {% assign newsletter_color_scheme = block.settings.color_scheme | default: section_color_scheme %}
          <div class="color-scheme color-{{ newsletter_color_scheme }} footer__newsletter-section" {{ block.shopify_attributes }}>
            <h3 class="footer__newsletter-title">{{ block.settings.title | default: section.settings.newsletter_title | default: 'Get new tech guides & exclusive deals.' }}</h3>
            {% assign desc_text = block.settings.text | default: section.settings.newsletter_text %}
            {% if desc_text != blank %}
              <p class="footer__newsletter-text">{{ desc_text }}</p>
            {% endif %}
            <form 
              action="/contact#contact_form" 
              method="post" 
              class="footer__newsletter-form"
              accept-charset="UTF-8"
              data-newsletter-form
            >
              <input type="hidden" name="form_type" value="customer">
              <input type="hidden" name="utf8" value="âœ“">
              <input type="hidden" name="contact[tags]" value="newsletter">
              <div class="footer__newsletter-input-wrapper">
                <input 
                  type="email" 
                  name="contact[email]" 
                  placeholder="{{ 'footer.newsletter_placeholder' | t | default: 'Enter your email' }}"
                  class="footer__newsletter-input"
                  required
                  aria-label="Email address"
                >
                <button 
                  type="submit" 
                  class="btn btn-primary footer__newsletter-button"
                  aria-label="Subscribe"
                >
                  {% render 'icon', name: 'arrow-right-long', class: 'w-5 h-5' %}
                </button>
              </div>
            </form>
          </div>
      {% endcase %}
    {% endfor %}

    {%comment%} Main Footer Content: Navigation + Contact {%endcomment%}
    <div class="footer__main">
      {%comment%} Navigation Columns - Dynamic from menu structure {%endcomment%}
      {% if menu_links.size > 0 %}
        <div class="footer__nav-section">
          <div class="footer__nav-grid" style="--footer-columns: {{ menu_links.size }};">
            {% for link in menu_links %}
              {% assign column_index = forloop.index %}
              {% if link.links.size > 0 %}
                <div class="footer__nav-column" data-footer-column>
                  <button 
                    type="button"
                    class="footer__nav-column-toggle"
                    data-footer-toggle
                    aria-expanded="false"
                    aria-controls="footer-column-{{ column_index }}"
                  >
                    <h3 class="footer__heading">{{ link.title }}</h3>
                    {% render 'icon', name: 'chevron-down', class: 'footer__toggle-icon w-4 h-4' %}
                  </button>
                  <ul class="footer__nav-list" id="footer-column-{{ column_index }}">
                    {% for child_link in link.links %}
                      <li>
                        <a href="{{ child_link.url }}" class="footer__nav-link">
                          {{ child_link.title }}
                        </a>
                      </li>
                    {% endfor %}
                  </ul>
                </div>
              {% else %}
                {%comment%} If no child links, show parent link as a single item {%endcomment%}
                <div class="footer__nav-column" data-footer-column>
                  <button 
                    type="button"
                    class="footer__nav-column-toggle"
                    data-footer-toggle
                    aria-expanded="false"
                    aria-controls="footer-column-{{ column_index }}"
                  >
                    <h3 class="footer__heading">{{ link.title }}</h3>
                    {% render 'icon', name: 'chevron-down', class: 'footer__toggle-icon w-4 h-4' %}
                  </button>
                  <ul class="footer__nav-list" id="footer-column-{{ column_index }}">
                    <li>
                      <a href="{{ link.url }}" class="footer__nav-link">
                        {{ link.title }}
                      </a>
                    </li>
                  </ul>
                </div>
              {% endif %}
            {% endfor %}
          </div>
        </div>
      {% endif %}

      {%comment%} Contact Section {%endcomment%}
      {% if section.settings.show_contact %}
        <div class="footer__contact-section">
          <h3 class="footer__heading">{{ section.settings.contact_title | default: 'Contact Us' }}</h3>
          
          {%comment%} Email {%endcomment%}
          {% if section.settings.contact_email != blank %}
            <a href="mailto:{{ section.settings.contact_email }}" class="footer__contact-link">
              {% render 'icon', name: 'mail', class: 'w-5 h-5' %}
              <span>{{ section.settings.contact_email }}</span>
            </a>
          {% endif %}

          {%comment%} Social Media Links {%endcomment%}
          {% if section.settings.show_social_links %}
            <div class="footer__social">
              {% if settings.social_instagram_link != blank %}
                <a 
                  href="{{ settings.social_instagram_link }}" 
                  class="footer__social-link" 
                  target="_blank" 
                  rel="noopener"
                  aria-label="Instagram"
                >
                  {% render 'icon', name: 'instagram', class: 'w-5 h-5' %}
                </a>
              {% endif %}
              {% if settings.social_facebook_link != blank %}
                <a 
                  href="{{ settings.social_facebook_link }}" 
                  class="footer__social-link" 
                  target="_blank" 
                  rel="noopener"
                  aria-label="Facebook"
                >
                  {% render 'icon', name: 'facebook', class: 'w-5 h-5' %}
                </a>
              {% endif %}
              {% if settings.social_tiktok_link != blank %}
                <a 
                  href="{{ settings.social_tiktok_link }}" 
                  class="footer__social-link" 
                  target="_blank" 
                  rel="noopener"
                  aria-label="TikTok"
                >
                  {% render 'icon', name: 'tiktok', class: 'w-5 h-5' %}
                </a>
              {% endif %}
              {% if settings.social_youtube_link != blank %}
                <a 
                  href="{{ settings.social_youtube_link }}" 
                  class="footer__social-link" 
                  target="_blank" 
                  rel="noopener"
                  aria-label="YouTube"
                >
                  {% render 'icon', name: 'youtube', class: 'w-5 h-5' %}
                </a>
              {% endif %}
              {% if settings.social_twitter_link != blank %}
                <a 
                  href="{{ settings.social_twitter_link }}" 
                  class="footer__social-link" 
                  target="_blank" 
                  rel="noopener"
                  aria-label="Twitter / X"
                >
                  {% render 'icon', name: 'twitter', class: 'w-5 h-5' %}
                </a>
              {% endif %}
            </div>
          {% endif %}
        </div>
      {% endif %}
    </div>

    {%comment%} Footer Bottom: Copyright + Payment Icons {%endcomment%}
    <div class="footer__bottom">
      <div class="footer__bottom-left">
        <p class="footer__copyright">
          &copy; {{ 'now' | date: '%Y' }} {{ shop.name }}{% if section.settings.copyright_text != blank %}. {{ section.settings.copyright_text }}{% endif %}
        </p>
      </div>
      
      {% if section.settings.show_payment_icons %}
        <div class="footer__payment-icons">
          {% for type in shop.enabled_payment_types %}
            {{ type | payment_type_svg_tag: class: 'footer__payment-icon' }}
          {% endfor %}
        </div>
      {% endif %}
    </div>
  </div>
</footer>

{% stylesheet %}
/* Footer Base */
.site-footer {
  background-color: var(--color-background);
  color: var(--color-foreground);
  border-top: 1px solid rgb(var(--color-border-rgb) / 0.4);
  margin-top: auto;
}

.footer__container {
  padding-top: clamp(48px, 8vw, 64px);
  padding-bottom: var(--spacing-8);
}

/* Newsletter Section - Full Width - Material Design Elevation */
.footer__newsletter-section {
  text-align: center;
  padding-bottom: 48px;
  border-bottom: 1px solid rgb(var(--color-border-rgb) / 0.4);
  margin-bottom: 48px;
}

.footer__newsletter-title {
  font-size: clamp(1.5rem, 5vw, 2rem);
  font-weight: 700;
  margin: 0 0 var(--spacing-6);
  color: var(--color-foreground);
  letter-spacing: -0.02em;
  line-height: 1.2;
}

.footer__newsletter-text {
  font-size: var(--text-size-sm);
  color: var(--color-foreground);
  opacity: 0.7;
  margin: 0 0 var(--spacing-6);
}

.footer__newsletter-form {
  max-width: 500px;
  margin: 0 auto;
}

.footer__newsletter-input-wrapper {
  display: flex;
  gap: 8px;
  background-color: rgb(var(--color-background-rgb) / 0.9);
  border: 1px solid rgb(var(--color-border-rgb) / 0.6);
  border-radius: var(--radius-md);
  padding: 6px;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.footer__newsletter-input-wrapper:focus-within {
  border-color: var(--color-primary);
  box-shadow: 0 0 0 4px rgb(var(--color-primary-rgb) / 0.2);
}

.footer__newsletter-input {
  flex: 1;
  padding: 12px 16px;
  border: none;
  background: transparent;
  font-size: 14px;
  color: var(--color-foreground);
  outline: none;
}

.footer__newsletter-input::placeholder {
  color: var(--color-foreground);
  opacity: 0.5;
}

.footer__newsletter-button {
  min-width: 44px;
  height: 44px;
  padding: 0 var(--spacing-4);
}

/* Main Footer Content */
.footer__main {
  display: grid;
  grid-template-columns: 1fr;
  gap: clamp(32px, 6vw, 64px);
  margin-bottom: clamp(32px, 6vw, 48px);
}

/* Navigation Section */
.footer__nav-section {
  flex: 1;
}

.footer__nav-grid {
  display: grid;
  grid-template-columns: repeat(var(--footer-columns), 1fr);
  gap: clamp(24px, 4vw, 48px);
}

.footer__nav-column {
  min-width: 0;
}

.footer__nav-column-toggle {
  display: flex;
  align-items: center;
  justify-content: space-between;
  width: 100%;
  padding: 0;
  background: none;
  border: none;
  cursor: pointer;
  text-align: left;
  margin-bottom: var(--spacing-4);
}

.footer__nav-column-toggle .footer__heading {
  margin: 0;
  pointer-events: none;
  cursor: default;
}

.footer__toggle-icon {
  display: block;
  transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  flex-shrink: 0;
}

.footer__nav-column-toggle[aria-expanded="true"] .footer__toggle-icon {
  transform: rotate(180deg);
}

.footer__nav-list {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: var(--spacing-3);
}

.footer__nav-link {
  display: inline-flex;
  align-items: center;
  font-size: var(--text-size-sm);
  color: rgb(var(--color-foreground-rgb) / 0.7);
  text-decoration: none;
  border-radius: var(--radius-full);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.footer__nav-link:hover,
.footer__nav-link:focus-visible {
  color: rgb(var(--color-foreground-rgb) / 0.9);
  background-color: transparent;
}

.footer__nav-link:focus-visible {
  outline: 2px solid rgb(var(--color-primary-rgb) / 0.35);
  outline-offset: 2px;
}

/* Contact Section */
.footer__contact-section {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-3);
}

.footer__contact-section .footer__heading {
  margin-bottom: var(--spacing-2);
}

.footer__contact-link {
  display: inline-flex;
  align-items: center;
  gap: var(--spacing-3);
  font-size: var(--text-size-sm);
  color: rgb(var(--color-foreground-rgb) / 0.7);
  text-decoration: none;
  border-radius: var(--radius-full);
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.footer__contact-link:hover,
.footer__contact-link:focus-visible {
  color: rgb(var(--color-foreground-rgb) / 0.9);
  background-color: transparent;
}

.footer__contact-link:focus-visible {
  outline: 2px solid rgb(var(--color-primary-rgb) / 0.35);
  outline-offset: 2px;
}

.footer__social {
  display: flex;
  gap: var(--spacing-3);
  margin-top: var(--spacing-2);
}

.footer__social-link {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  border-radius: var(--radius-full);
  background-color: rgb(var(--color-foreground-rgb) / 0.06);
  color: var(--color-foreground);
  text-decoration: none;
  transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

.footer__social-link:hover {
  background-color: var(--color-primary);
  color: var(--color-background);
  transform: translateY(-2px);
}

/* Footer Heading */
.footer__heading {
  font-size: var(--text-size-base);
  font-weight: 600;
  margin: 0 0 var(--spacing-4);
  color: var(--color-foreground);
  letter-spacing: -0.01em;
}

.heyup-footer .footer__heading {
  font-weight: 400;
}

/* Footer Bottom */
.footer__bottom {
  display: flex;
  flex-direction: column;
  gap: var(--spacing-6);
  padding-top: var(--spacing-8);
  border-top: 1px solid rgb(var(--color-border-rgb) / 0.4);
}

.footer__copyright {
  font-size: var(--text-size-xs);
  color: var(--color-foreground);
  opacity: 0.6;
  margin: 0;
}

.footer__payment-icons {
  display: flex;
  flex-wrap: wrap;
  gap: var(--spacing-3);
  align-items: center;
}

.footer__payment-icon {
  height: 24px;
  width: auto;
  opacity: 0.6;
  transition: opacity 0.2s ease;
}

.footer__payment-icon:hover {
  opacity: 1;
}

/* Mobile: Collapsible Columns */
@media screen and (max-width: 989px) {
  .footer__nav-list {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    opacity: 0;
  }
  
  .footer__nav-column-toggle[aria-expanded="true"] + .footer__nav-list {
    max-height: 500px;
    opacity: 1;
  }
  
  .footer__nav-grid {
    grid-template-columns: 1fr;
    gap: var(--spacing-6);
  }
  
  .footer__main {
    grid-template-columns: 1fr;
  }
  
  /* Ensure toggle button is visible and clickable */
  .footer__nav-column-toggle {
    pointer-events: auto;
  }
}

/* Desktop Breakpoint */
@media screen and (min-width: 990px) {
  .footer__main {
    grid-template-columns: 1fr auto;
    align-items: start;
  }
  
  .footer__nav-column-toggle {
    pointer-events: none;
    cursor: default;
  }
  
  .footer__toggle-icon {
    display: none;
  }
  
  .footer__nav-list {
    max-height: none !important;
    opacity: 1 !important;
    display: flex !important;
  }
  
  .footer__contact-section {
    min-width: 200px;
  }
  
  .footer__bottom {
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
  }
}

/* Reduced Motion */
@media (prefers-reduced-motion: reduce) {
  .footer__nav-link,
  .footer__social-link,
  .footer__newsletter-button,
  .footer__toggle-icon {
    transition: none !important;
  }
  
  .footer__nav-link:hover {
    transform: none;
  }
  
  .footer__social-link:hover {
    transform: none;
  }
}
{% endstylesheet %}

{% javascript %}
class FooterComponent {
  constructor() {
    this.toggles = document.querySelectorAll('[data-footer-toggle]');
    this.init();
  }
  
  init() {
    // Initialize desktop: all menus expanded
    if (window.innerWidth >= 990) {
      this.toggles.forEach(toggle => {
        toggle.setAttribute('aria-expanded', 'true');
      });
    }
    
    // Add click handlers for mobile
    this.toggles.forEach(toggle => {
      toggle.addEventListener('click', () => {
        // Only toggle on mobile
        if (window.innerWidth < 990) {
          this.toggleMenu(toggle);
        }
      });
    });
    
    // Handle window resize
    window.addEventListener('resize', () => {
      if (window.innerWidth >= 990) {
        // Desktop: expand all
        this.toggles.forEach(toggle => {
          toggle.setAttribute('aria-expanded', 'true');
          const column = toggle.closest('[data-footer-column]');
          const list = column?.querySelector('.footer__nav-list');
          if (list) {
            list.style.maxHeight = 'none';
          }
        });
      } else {
        // Mobile: collapse all
        this.toggles.forEach(toggle => {
          toggle.setAttribute('aria-expanded', 'false');
          const column = toggle.closest('[data-footer-column]');
          const list = column?.querySelector('.footer__nav-list');
          if (list) {
            list.style.maxHeight = '0';
          }
        });
      }
    });
  }
  
  toggleMenu(toggle) {
    const isExpanded = toggle.getAttribute('aria-expanded') === 'true';
    const column = toggle.closest('[data-footer-column]');
    const list = column?.querySelector('.footer__nav-list');
    
    if (!list) return;
    
    // Toggle aria-expanded
    toggle.setAttribute('aria-expanded', !isExpanded);
    
    // Toggle list visibility
    if (isExpanded) {
      list.style.maxHeight = '0';
      list.style.opacity = '0';
    } else {
      list.style.maxHeight = list.scrollHeight + 'px';
      list.style.opacity = '1';
    }
  }
}

// Initialize when DOM is ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', () => new FooterComponent());
} else {
  new FooterComponent();
}
{% endjavascript %}

{% schema %}
{
  "name": "Footer",
  "class": "section-footer",
  "settings": [
    {
      "type": "header",
      "content": "Newsletter"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "checkbox",
      "id": "show_newsletter",
      "label": "Show newsletter signup",
      "default": true
    },
    {
      "type": "text",
      "id": "newsletter_title",
      "label": "Newsletter title",
      "default": "Get new tech guides & exclusive deals."
    },
    {
      "type": "text",
      "id": "newsletter_text",
      "label": "Newsletter description",
      "default": "Subscribe to get special offers and updates"
    },
    {
      "type": "header",
      "content": "Navigation Menu"
    },
    {
      "type": "link_list",
      "id": "footer_menu",
      "label": "Footer menu",
      "default": "footer",
      "info": "Select a menu with nested items. First-level items will be column titles (not clickable), second-level items will be links."
    },
    {
      "type": "header",
      "content": "Contact Section"
    },
    {
      "type": "checkbox",
      "id": "show_contact",
      "label": "Show contact section",
      "default": true
    },
    {
      "type": "text",
      "id": "contact_title",
      "label": "Contact title",
      "default": "Contact Us"
    },
    {
      "type": "text",
      "id": "contact_email",
      "label": "Contact email",
      "default": "hello@example.com"
    },
    {
      "type": "checkbox",
      "id": "show_social_links",
      "label": "Show social media links",
      "default": true,
      "info": "Configure social media links in Theme Settings"
    },
    {
      "type": "header",
      "content": "Footer Bottom"
    },
    {
      "type": "text",
      "id": "copyright_text",
      "label": "Copyright text",
      "default": "All rights reserved"
    },
    {
      "type": "checkbox",
      "id": "show_payment_icons",
      "label": "Show payment icons",
      "default": true
    }
  ],
  "blocks": [
    {
      "type": "newsletter",
      "name": "Newsletter subscribe",
      "limit": 1,
      "settings": [
        {
          "type": "color_scheme",
          "id": "color_scheme",
          "label": "Color scheme",
          "default": "scheme-1"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Get new tech guides & exclusive deals."
        },
        {
          "type": "text",
          "id": "text",
          "label": "Description"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Footer",
      "blocks": [
        { "type": "newsletter" }
      ]
    }
  ]
}
{% endschema %}
