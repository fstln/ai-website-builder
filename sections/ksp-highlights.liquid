{%- comment -%}
  Responsive grid for showcasing multiple key selling points in card form.
  Supports single- and double-card rows so merchants can mix storytelling layouts.
{%- endcomment -%}

{%- liquid
  assign fallback_section_id = 'ksp-highlights-' | append: section.index
  assign section_id = section.settings.section_id | default: fallback_section_id
  assign heading = section.settings.heading
  assign subheading = section.settings.subheading
  assign description = section.settings.description
  assign eyebrow = section.settings.eyebrow
-%}

<section
  id="{{ section_id | escape }}"
  class="color-scheme color-{{ section.settings.color_scheme }} bg-background py-16 sm:py-20 lg:py-24"
  data-section-id="{{ section.id }}"
>
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="mx-auto max-w-3xl text-center">
      {%- if eyebrow != blank -%}
        <p class="text-sm font-semibold uppercase tracking-wide text-primary">{{ eyebrow }}</p>
      {%- endif -%}
      {%- if heading != blank -%}
        <h2 class="mt-2 text-3xl font-bold tracking-tight text-foreground sm:text-4xl lg:text-5xl font-heading">
          {{ heading }}
        </h2>
      {%- endif -%}
      {%- if subheading != blank -%}
        <p class="mt-4 text-lg leading-7 text-muted">
          {{ subheading }}
        </p>
      {%- endif -%}
      {%- if description != blank -%}
        <div class="mt-4 text-base leading-7 text-muted">
          {{ description }}
        </div>
      {%- endif -%}
    </div>

    {%- if section.blocks.size > 0 -%}
      <div class="mt-12 flex flex-col gap-10">
        {%- for block in section.blocks -%}
          {%- case block.type -%}
            {%- when 'two_card_row' -%}
              <div class="grid grid-cols-1 gap-8 md:grid-cols-2" {{ block.shopify_attributes }}>
                {%- render 'ksp-card',
                  image: block.settings.first_image,
                  label: block.settings.first_label,
                  title: block.settings.first_title,
                  description: block.settings.first_body,
                  placeholder: 'Add first card content',
                  text_layout: block.settings.first_text_layout
                -%}
                {%- render 'ksp-card',
                  image: block.settings.second_image,
                  label: block.settings.second_label,
                  title: block.settings.second_title,
                  description: block.settings.second_body,
                  placeholder: 'Add second card content',
                  text_layout: block.settings.second_text_layout
                -%}
              </div>
            {%- when 'single_card_row' -%}
              <div class="grid grid-cols-1 gap-8" {{ block.shopify_attributes }}>
                {%- render 'ksp-card',
                  image: block.settings.card_image,
                  label: block.settings.card_label,
                  title: block.settings.card_title,
                  description: block.settings.card_body,
                  placeholder: 'Add KSP content',
                  text_layout: block.settings.card_text_layout
                -%}
              </div>
          {%- endcase -%}
        {%- endfor -%}
      </div>
    {%- else -%}
      <div class="mt-12 rounded-2xl border border-dashed border-border bg-surface px-6 py-12 text-center text-base text-muted">
        Add blocks to highlight the differentiators of your product.
      </div>
    {%- endif -%}
  </div>
</section>

{% schema %}
{
  "name": "KSP highlight grid",
  "tag": "section",
  "class": "ksp-highlight-section",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-2"
    },
    {
      "type": "text",
      "id": "eyebrow",
      "label": "Eyebrow label",
      "default": "Key Selling Points"
    },
    {
      "type": "text",
      "id": "section_id",
      "label": "Section ID",
      "info": "Used for anchor links. Defaults to ksp-highlights-{index} when left blank."
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Why customers choose us"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "Stack multiple KSP cards to cover every differentiator."
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description"
    }
  ],
  "blocks": [
    {
      "type": "two_card_row",
      "name": "Two-card row",
      "settings": [
        { "type": "image_picker", "id": "first_image", "label": "First card image" },
        { "type": "text", "id": "first_label", "label": "First card label" },
        {
          "type": "text",
          "id": "first_title",
          "label": "First card title",
          "default": "Comfortable enough to forget"
        },
        {
          "type": "richtext",
          "id": "first_body",
          "label": "First card description",
          "default": "<p>Explain the standout benefit in 1-2 punchy sentences.</p>"
        },
        {
          "type": "select",
          "id": "first_text_layout",
          "label": "First card text layout",
          "options": [
            { "value": "stacked", "label": "Text above image" },
            { "value": "overlay", "label": "Text overlay on top of the image" }
          ],
          "default": "stacked"
        },
        { "type": "image_picker", "id": "second_image", "label": "Second card image" },
        { "type": "text", "id": "second_label", "label": "Second card label" },
        {
          "type": "text",
          "id": "second_title",
          "label": "Second card title",
          "default": "Stay fully aware"
        },
        {
          "type": "richtext",
          "id": "second_body",
          "label": "Second card description",
          "default": "<p>Use supporting copy to expand on the value prop.</p>"
        },
        {
          "type": "select",
          "id": "second_text_layout",
          "label": "Second card text layout",
          "options": [
            { "value": "stacked", "label": "Text above image" },
            { "value": "overlay", "label": "Text overlay on top of the image" }
          ],
          "default": "stacked"
        },
        {
          "type": "paragraph",
          "content": "Tip: When using an overlay layout, leave safe space at the top of the asset so the copy has room."
        }
      ]
    },
    {
      "type": "single_card_row",
      "name": "Single-card row",
      "settings": [
        { "type": "image_picker", "id": "card_image", "label": "Card image" },
        { "type": "text", "id": "card_label", "label": "Card label" },
        {
          "type": "text",
          "id": "card_title",
          "label": "Card title",
          "default": "Immersive bass, no ear fatigue"
        },
        {
          "type": "richtext",
          "id": "card_body",
          "label": "Card description",
          "default": "<p>Long-form proof or descriptive detail goes here.</p>"
        },
        {
          "type": "select",
          "id": "card_text_layout",
          "label": "Card text layout",
          "options": [
            { "value": "stacked", "label": "Text above image" },
            { "value": "overlay", "label": "Text overlay on top of the image" }
          ],
          "default": "stacked"
        },
        {
          "type": "paragraph",
          "content": "Tip: Overlay mode needs empty space along the upper portion of the image."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "KSP highlight grid",
      "blocks": [
        { "type": "two_card_row" },
        { "type": "two_card_row" },
        { "type": "single_card_row" }
      ]
    }
  ]
}
{% endschema %}
