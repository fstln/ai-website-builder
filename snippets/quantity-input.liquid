{% comment %}
  Quantity Input Component
  A reusable quantity selector with increment/decrement buttons
  
  Usage:
    {% render 'quantity-input', 
      id: 'Quantity-' | append: line_item.key,
      name: 'updates[' | append: line_item.key | append: ']',
      value: line_item.quantity,
      min: 0,
      max: line_item.variant.inventory_quantity,
      label: 'Quantity'
    %}
  
  Parameters:
    - id: Input ID (required for accessibility)
    - name: Input name attribute (e.g., 'updates[line_key]' for cart items)
    - value: Current quantity value (default: 1)
    - min: Minimum quantity (default: 1)
    - max: Maximum quantity (optional)
    - label: Label text for screen readers
    - disabled: Boolean to disable the input
    - class: Additional CSS classes for the wrapper
{% endcomment %}

{%- liquid
  assign qty_id = id | default: 'Quantity'
  assign qty_name = name | default: 'quantity'
  assign qty_value = value | default: 1
  assign qty_min = min | default: 1
  assign qty_label = label | default: 'Quantity'
  assign is_disabled = disabled | default: false
  assign component_name = 'quantity-selector-component'
  if line_index != null
    assign component_name = 'cart-quantity-selector-component'
  endif
-%}

<{{ component_name }} 
  class="quantity-selector inline-flex items-center bg-background border border-border rounded-lg overflow-hidden divide-x divide-border/70 shadow-sm {{ class }}"
  data-variant-id="{{ variant_id }}"
>
  <button
    type="button"
    class="quantity-minus flex items-center justify-center w-10 h-10 text-foreground-secondary hover:bg-border/20 hover:text-foreground active:bg-border/40 disabled:opacity-30 disabled:cursor-not-allowed disabled:hover:bg-transparent disabled:hover:text-foreground-secondary transition-colors cursor-pointer focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40"
    on:click="/decreaseQuantity"
    ref="minusButton"
    {% if is_disabled %}disabled{% endif %}
    {% unless line_index %}
      {% if qty_value <= qty_min %}disabled{% endif %}
    {% endunless %}
  >
    <span class="sr-only">{{ 'products.product.quantity_decrease' | t: product: qty_label }}</span>
    {% render 'icon', name: 'minus', class: 'w-4 h-4' %}
  </button>
  
  <input
    type="number"
    id="{{ qty_id }}"
    name="{{ qty_name }}"
    value="{{ qty_value }}"
    min="{{ qty_min }}"
    {% if max %}max="{{ max }}"{% endif %}
    {% if line_index %}
      data-cart-line="{{ line_index | plus: 1 }}"
    {% endif %}
    step="1"
    on:blur="/validateQuantity"
    on:focus="/selectInputValue"
    ref="quantityInput"
    aria-label="{{ 'products.product.quantity_input' | t: product: qty_label }}"
    class="quantity-input w-14 sm:w-16 h-10 text-center bg-background text-foreground font-semibold text-base focus:outline-none focus:bg-primary/10"
    {% if is_disabled %}disabled{% endif %}
  >
  
  <button
    type="button"
    class="quantity-plus flex items-center justify-center w-10 h-10 text-foreground-secondary hover:bg-border/20 hover:text-foreground active:bg-border/40 disabled:opacity-30 disabled:cursor-not-allowed disabled:hover:bg-transparent disabled:hover:text-foreground-secondary transition-colors cursor-pointer focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40"
    on:click="/increaseQuantity"
    ref="plusButton"
    {% if is_disabled %}disabled{% endif %}
    {% if max and qty_value >= max %}disabled{% endif %}
  >
    <span class="sr-only">{{ 'products.product.quantity_increase' | t: product: qty_label }}</span>
    {% render 'icon', name: 'plus', class: 'w-4 h-4' %}
  </button>
</{{ component_name }}>

{%- comment -%}
  Note: The JavaScript for this component is now in src/js/components/quantity-input.js
  and compiled into assets/main.js by Vite.
{%- endcomment -%}
